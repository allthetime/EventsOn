
    <style type="text/css">
      #map_canvas {
        width:100%;
        min-height:70vh;

      }
    </style>







    
    <% unless current_user.nil? && current_planner.nil? %>

      <form action="/logout" method="post">
          <input type="submit" value="logout"/>
      </form>

    <% else %>

      <form action="/login" method="post">
        <div>
          <input type="checkbox" name="planner"/>
        </div>
        <div>
        username
          <input 
            type="text" 
            name="name" />
        </div>
        <div>
        password
          <input 
            type="password" 
            name="password" />
        </div>

        <div>
          <input type="submit"/>
        </div>
      </form>

    <% end %>




    <% unless current_user.nil?  %>
      HI <%= current_user.name %>
    <% end %>

    <% unless current_planner.nil? %>
      HI planner <%= current_planner.name %>
    <% end %>    


    date:<input type="text" id="date_picker"></div>
    <select name="type">
    <% all_types.each do |type| %>
      <option value="<%= type.name %>"><%= type.name %></option>
    <% end %>
    </select>




    <button id="share_location" onclick="showlocation();">YOUR LOCATION</button>

    <script>
      function showlocation() {
         navigator.geolocation.getCurrentPosition(callback);
      }
      function callback(position) {
         lat = position.coords.latitude
         lng = position.coords.longitude
         map.setCenter(new google.maps.LatLng(lat, lng));
         map.setZoom(13);
      }
      var map
    </script>

    <div id='map_canvas' class='col-sm-8'>
    </div>



     
    <script type="text/javascript">

      $(function($) {
          var script = document.createElement('script');
          script.src = "http://maps.googleapis.com/maps/api/js?sensor=false&callback=initialize";
          document.body.appendChild(script);
      });

      function initialize() {
          var bounds = new google.maps.LatLngBounds();
          var mapOptions = {
          };

          map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
          map.setTilt(45);

          var markers = [
            <% all_events.each do |
              event | %>
              ["<%= event.name %>", <%= event.venue.latitude %> , <%= event.venue.longitude %> , "<%= event.link_url %>"], 
            <% end %>
          ];

          var infoWindowContent = [
            <% all_events.each do |event| %>
              [
                '<a href="<%= event.link_url %>"><h4><%= event.name %></h4></a>' +
                '<%= event.venue.address %>'
              ],
            <% end %>
          ];

          var infoWindow = new google.maps.InfoWindow({
                  maxWidth: 300
              }),
              marker, i;
          var markerList = [];

          for (i = 0; i < markers.length; i++) {
              var position = new google.maps.LatLng(markers[i][1], markers[i][2]);
              bounds.extend(position);
              marker = new google.maps.Marker({
                  position: position,
                  map: map,
                  title: markers[i][0],
                  animation: google.maps.Animation.DROP
              });
              marker.metadata = {
                  type: "point",
                  id: i
              };
              markerList.push(marker);

              google.maps.event.addListener(marker, 'click', (function(marker, i) {
                  return function() {
                      infoWindow.setContent(infoWindowContent[i][0]);
                      infoWindow.open(map, marker);
                  };
              })(marker, i));

              map.fitBounds(bounds);
              $('.stores ul').append('<li><a href=' + '"' + markers[i][3] + '"' + 'target="_blank"' + 'data-id="' + i + '"' + '>' + markers[i][0] + '</a></li>');
          }

          var foundMarkerId;

          $('.stores a').hover(function(e) {
              var targetLi = e.target.getAttribute('data-id');
              for (i = 0; i < markerList.length; i++) {
                  foundMarkerId = markerList[i].metadata.id;
                  if (foundMarkerId == targetLi) {
                      markerList[i].setAnimation(google.maps.Animation.BOUNCE);
                  }
              }
          }, function() {
              for (i = 0; i < markerList.length; i++) {
                  markerList[i].setAnimation(null);
              }
          });

          var boundsListener = google.maps.event.addListener((map), 'bounds_changed', function(event) {
              this.setZoom(12);
              google.maps.event.removeListener(boundsListener);
          });

          google.maps.event.addDomListener(map, "idle", function() {
              center = map.getCenter();
          });

          $(window).resize(function() {
              map.setCenter(center);
          });
      }


  $(function() {
    $( "#date_picker" ).datepicker();
  });


    </script>
